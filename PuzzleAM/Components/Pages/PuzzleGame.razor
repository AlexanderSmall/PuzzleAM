@page "/puzzlegame/{roomCode}"
@rendermode InteractiveServer

<PageTitle>Puzzle Game</PageTitle>

<div class="settings-wrapper mb-3">
    <div class="settings-panel @(settingsVisible ? "open" : "closed") d-flex flex-wrap justify-content-center align-items-center gap-2">
        <span class="puzzle-icon">üß©</span>
        <select @bind="selectedPieces" class="form-select w-auto">
            @foreach (var option in PieceOptions)
            {
                <option value="@option">@option</option>
            }
        </select>

        <InputFile id="imageLoader" OnChange="OnInputFileChange" class="d-none" />
        <label for="imageLoader" class="btn btn-primary load-icon" title="Load Image">üñºÔ∏è</label>

        <select @bind="selectedBackground" @bind:after="OnBackgroundChange" class="form-select color-select" style="background-color:@selectedBackground;">
            <option value="#EFECE6" style="background-color:#EFECE6;" selected></option>
            <option value="#E7F1DC" style="background-color:#E7F1DC;"></option>
            <option value="#C8D2C5" style="background-color:#C8D2C5;"></option>
        </select>

        @if (!string.IsNullOrEmpty(RoomCode))
        {
            <span>Room Code: @RoomCode</span>
            <button class="btn btn-outline-secondary copy-icon" @onclick="CopyRoomCode" title="Copy">üìã</button>
            <button class="btn btn-danger" @onclick="LeaveRoom">Leave Room</button>
        }
    </div>
    <button class="btn btn-outline-secondary settings-toggle" @onclick="ToggleSettings">
        @(settingsVisible ? "‚ñ≤" : "‚ñº")
    </button>
</div>

<div class="timer-display">Time: @elapsed.ToString(@"hh\:mm\:ss")</div>

<div id="puzzleContainer"></div>

<div class="user-panel">
    <h5>Users</h5>
    <ul>
        @foreach (var u in users)
        {
            <li>@u</li>
        }
    </ul>
</div>
